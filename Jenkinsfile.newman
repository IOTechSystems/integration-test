#!/usr/bin/env groovy

node ("${env.SLAVE}")
{
    stage ('Checkout')
    {
        cleanWs ()
        checkout scm
        sh 'git clone --branch v4.0.2 git@github.com:IOTechSystems/newman.git'
    }
    stage ('Build')
    {
        sh '. ./arch.sh'
        sh 'cd newman/docker/images/alpine33'
        sh 'docker build -t iotech_newman_$EX_ARCH:4.0.2'
    }
    stage ("Clean")
    { 
        sh 'docker image rm iotech_newman_$EX_ARCH:4.0.2'
        cleanWs ()
    }
}
